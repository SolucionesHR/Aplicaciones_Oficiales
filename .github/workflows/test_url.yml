name: И Debug Private Download (GH CLI)

on:
  workflow_dispatch:
    inputs:
      repo:
        description: "Repositorio privado (formato: owner/repo)"
        required: true
        default: "SolucionesHR/mercados_cuba_delivery"
      tag:
        description: "Tag o versi贸n del release"
        required: true
        default: "v1.0.5"
      pattern:
        description: "Patr贸n del nombre del archivo a descargar (por ejemplo *.apk)"
        required: true
        default: "mensajero.apk"

jobs:
  debug-gh-download:
    runs-on: ubuntu-latest

    steps:
      - name:  Iniciar flujo
        run: echo " Iniciando descarga privada con gh release download..."

      - name:  Verificar autenticaci贸n actual
        env:
          GH_TOKEN: ${{ secrets.PUBLIC_REPO_TOKEN }}
        run: |
          echo " Verificando autenticaci贸n de GH CLI..."
          gh auth status || echo "锔 GH CLI a煤n no autenticado, pero GH_TOKEN est谩 disponible."

      - name:  Descargar asset desde release privado
        env:
          GH_TOKEN: ${{ secrets.PUBLIC_REPO_TOKEN }}
        run: |
          echo " Descargando desde ${{ github.event.inputs.repo }} - tag ${{ github.event.inputs.tag }}"
          gh release download \
            ${{ github.event.inputs.tag }} \
            --repo "${{ github.event.inputs.repo }}" \
            --pattern "${{ github.event.inputs.pattern }}" \
            --verbose

      - name: Ь Verificar archivo descargado
        run: |
          echo " Archivos descargados:"
          ls -lh
          echo " Informaci贸n detallada del archivo:"
          file "${{ github.event.inputs.pattern }}"
